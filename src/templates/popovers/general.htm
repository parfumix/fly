<div class="popover" data-id="general">
    <div>
        <div class="root"></div>

        <span class="edit">edit</span>
        <span class="remove">remove</span>

        <script type="text/javascript">
            (function($) {
                var data = $('.root').data(),
                        avatar = data['avatar'],
                        panel = data['panel'],
                        tooltip = data['tooltip'],
                        element = avatar.get_element();

                $('.remove').on('click', function () {
                    avatar.remove_from_dom();
                });

                $('.edit').on('click', function () {
                    panel.on('save', function (ui, attributes) {
                        avatar.fill(attributes);

                        element.attr('class', attributes.size + ' avatar');

                        $(element).html(
                                avatar.get_template(false)
                        );

                        $(element).data('avatar', avatar);
                    });

                    $('[data-toggle=popover]').popover('hide');

                    panel.open();
                });
            })(jQuery)
        </script>
    </div>
</div>